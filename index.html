<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="utf-8">
    <title>Strona SPA z Listą Klientów</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="style.css" rel="stylesheet">
</head>
<body>

<section id="formSection">
    <h3>Formularz</h3>
    <form id="Form" onsubmit="getElements(event)" class="row g-4">
        <div class="col-md-6">
            <label for="inputName" class="form-label">Nazwa Firmy</label>
            <input type="text" class="form-control" id="inputName" required>
        </div>
        <div class="col-md-6">
            <label for="inputNIP" class="form-label">NIP</label>
            <input type="text" class="form-control" pattern="\d{10}" title="NIP musi składać się z 10 cyfr" id="inputNIP" required>
        </div>
        <div class="col-6">
            <label for="inputMiasto" class="form-label">Miasto</label>
            <input type="text" class="form-control" id="inputMiasto" placeholder="Krakow" required>
        </div>
        <div class="col-6">
            <label for="inputUlica" class="form-label">Ulica</label>
            <input type="text" class="form-control" id="inputUlica" placeholder="Krakowska" required>
        </div>
        <div class="col-md-6">
            <label for="inputNumber" class="form-label">Numer Domu</label>
            <input type="text" class="form-control" id="inputNumber" required>
        </div>
        <div class="col-md-6">
            <label for="inputNumberM" class="form-label">Numer Mieszkania</label>
            <input type="number" class="form-control" id="inputNumberM">
        </div>
        <div class="col-md-6">
            <label for="inputKod" class="form-label">Kod Pocztowy</label>
            <input type="text" class="form-control" pattern="\d{2}-\d{3}" title="Kod pocztowy musi mieć format xx-xxx" id="inputKod" required>
        </div>
        <div class="col-md-12">
            <label for="inputUwagi">Uwagi</label>
            <textarea class="form-control" placeholder="Zostaw uwagi tutaj" id="inputUwagi"></textarea>
        </div>
        <div class="form-floating">
            <select class="form-select" id="inputBranza" required>
                <option selected>Wybierz branżę</option>
                <option value="1">Finanse</option>
                <option value="2">Informatyka</option>
                <option value="3">Motoryzacja</option>
            </select>
        </div>
        <div class="col-12">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="inputCheck">
                <label class="form-check-label" for="inputCheck">Aktywny</label>
            </div>
        </div>
        <div>
            <button type="submit" class="btn btn-primary">Dodaj klienta</button>
        </div>
        <div>
            <button type="button" onclick="showList()" class="btn btn-primary">Pokaż Listę</button>
        </div>
        <div>
            <button type="button" onclick="fillForm()" class="btn btn-secondary">Wstaw dane i zablokuj</button>
        </div>
    </form>
</section>

<section id="login-form" style="display: none;">
    <h1>Lista Klientów</h1>
    <ul class="list-group" id="clientList"></ul>
    <div>
        <button type="button" onclick="showForm()" class="btn btn-primary">Pokaż Formularz</button>
    </div>
</section>

<script>
    let customerList = [];
    let editingIndex = null; // Indeks edytowanego klienta

    function getElements(event) {
        event.preventDefault();

        const name = document.getElementById("inputName").value;
        const NIP = document.getElementById("inputNIP").value;
        const miasto = document.getElementById("inputMiasto").value;
        const ulica = document.getElementById("inputUlica").value;
        const number = document.getElementById("inputNumber").value;
        const numberM = document.getElementById("inputNumberM").value || null;
        const kod = document.getElementById("inputKod").value;
        const uwagi = document.getElementById('inputUwagi').value || null;
        const branza = document.getElementById('inputBranza').value;
        const check = document.getElementById('inputCheck').checked;

        const formData = {
            name: name,
            NIP: NIP,
            miasto: miasto,
            ulica: ulica,
            number: number,
            numberM: numberM,
            kod: kod,
            uwagi: uwagi,
            branza: branza,
            check: check
        };

        if (editingIndex !== null) {
            // Edytowanie istniejącego klienta
            customerList[editingIndex] = formData; // Aktualizacja danych klienta
            editingIndex = null; // Resetowanie indeksu po edytowaniu
        } else {
            // Dodawanie nowego klienta
            customerList.push(formData);
        }

        showList();
        resetForm();
    }

    function resetForm() {
        document.getElementById('Form').reset();
        document.getElementById('inputCheck').checked = false; // Resetowanie checkboxa
        editingIndex = null; // Resetowanie indeksu
        enableFormInputs(true); // Umożliwienie edytowania pól
    }

    function enableFormInputs(enable) {
        const inputs = document.querySelectorAll("#Form input, #Form textarea, #Form select");
        inputs.forEach(input => {
            input.disabled = !enable; // Blokowanie lub odblokowywanie pól
        });
    }

    function showList() {
        document.getElementById('login-form').style.display = 'block';
        document.getElementById('formSection').style.display = 'none';

        const ul = document.getElementById("clientList");
        ul.innerHTML = ""; // Czyści listę przed dodaniem nowych elementów

        customerList.forEach((customer, index) => {
            let li = document.createElement("li");
            li.className = "list-group-item";
            li.innerHTML = `
                <strong>Nazwa:</strong> ${customer.name}, <strong>NIP:</strong> ${customer.NIP}, <strong>Miasto:</strong> ${customer.miasto}
                <button onclick="editClient(${index})" class="btn btn-sm btn-secondary">Edytuj</button>
                <button onclick="deleteClient(${index})" class="btn btn-sm btn-danger">Usuń</button>
            `;
            ul.appendChild(li);
        });
    }

    function showForm() {
        document.getElementById('formSection').style.display = 'block';
        document.getElementById('login-form').style.display = 'none';
        resetForm(); // Resetuje formularz przy każdym otwarciu
    }

    function editClient(index) {
        const client = customerList[index];
        document.getElementById("inputName").value = client.name;
        document.getElementById("inputNIP").value = client.NIP;
        document.getElementById("inputMiasto").value = client.miasto;
        document.getElementById("inputUlica").value = client.ulica;
        document.getElementById("inputNumber").value = client.number;
        document.getElementById("inputNumberM").value = client.numberM || '';
        document.getElementById("inputKod").value = client.kod;
        document.getElementById("inputUwagi").value = client.uwagi || '';
        document.getElementById("inputBranza").value = client.branza;
        document.getElementById("inputCheck").checked = client.check;

        // Ustaw indeks edytowanego klienta
        editingIndex = index;

        // Przełącza się na formularz, aby edytować klienta
        showForm(); 
    }

    function fillForm() {
        document.getElementById("inputName").value = "Firma ABCD";
        document.getElementById('inputNIP').value = "1234567890";
        document.getElementById('inputMiasto').value = "Warszawa";
        document.getElementById('inputUlica').value = "Długa";
        document.getElementById('inputNumber').value = "10";
        document.getElementById('inputNumberM').value = "5";
        document.getElementById('inputKod').value = "00-001";
        document.getElementById('inputUwagi').value = "Brak uwag";
        document.getElementById('inputBranza').value = "1";
        document.getElementById('inputCheck').checked = true;

        enableFormInputs(false); // Blokowanie pól formularza
    }

    function deleteClient(index) {
        customerList.splice(index, 1); // Usunięcie klienta z listy
        showList(); // Odświeżenie listy
    }
</script>

</body>
</html>
